wsNs.updateParameterInQueryString=function(a,b,h){var f=h.indexOf("?");var i=f>-1?h.substring(0,f):h;var e=f>-1?h.substring(f+1):"";var g=e?e.split("&"):[];var c=encodeURIComponent(a)+"=";var d;for(d=0;d<g.length;++d){if(g[d].indexOf(c)>-1){break}}g[d]=c+encodeURIComponent(b);e=g.join("&");return i+"?"+e};String.prototype.updateParameterInQueryString=function(a,b){return wsNs.updateParameterInQueryString(a,b,this)};wsNs.logDeferredClick=function(b,a){iclog.logClick(a,$(b).attr(wsNs.constants.coidDeferAttribute),$(b).attr(wsNs.constants.copDeferAttribute))};wsNs.logClickAndNavigate=function(a,b,c){if(wsNs.constants.openInNewWindow){window.open(c);iclog.logClick(null,a,b)}else{iclog.logClick(function(){window.location=c},a,b)}};wsNs.hideAdvSearch=function(a,b){$(".advancedSearchScreen").hide();a.fadeOut("slow",function(){$('input[name="q"]').attr("disabled",false).css("background-color","#fff");$("#topSearchSubmit").attr("disabled",false).css("cursor","pointer")})};wsNs.showAdvSearch=function(a,b){if($("#suggestPanel").is(":visible")){$("#suggestPanel").hide()}$("div.advancedSearchPane").center();$(".advancedSearchScreen").show();a.fadeIn("slow",function(){wsNs.logDeferredClick(b);$('input[name="q"]').attr("disabled",true).css("background-color","#ccc");$("#topSearchSubmit").attr("disabled",true).css("cursor","default");$("#qall").focus()})};wsNs.saveLocation=function(a){$.post(wsNs.constants.locationPost,{latitude:a.coords.latitude,longitude:a.coords.longitude})};wsNs.getLocation=function(a){navigator.geolocation.getCurrentPosition(a||wsNs.saveLocation)};(function(){var b;var a;wsNs.showOverlay=function(e,c){var d=function(){a=new Date().getTime();$("#overlayText").text(e);$("#overlay, #overlayScreen").height($(window).height()).width($(window).width());$("#overlay").css("padding-top",(($("#overlay").height()-parseInt($("#overlayContent").css("height")))/2).toString()+"px").css("position","fixed").fadeIn("fast")};if(c){b=setTimeout(d,c)}else{d()}};wsNs.hideOverlay=function(e,c){clearTimeout(b);var d=new Date().getTime()-a;var g=function(){if(c){c()}$("#overlay").fadeOut("fast",function(){$(this).css("position","static")})};if(e&&d<e){setTimeout(g,e-d)}else{g()}}})();wsNs.registerSearchHistory=function(){if(icl.ut.getCookie("__hideHistory")=="1"){$("#showHistoryLink").show();$("#hideHistoryLink").hide();$("#searchHistoryContent").hide();$("#clearHistoryLink").show()}else{$("#showHistoryLink").hide();$("#hideHistoryLink").show();$("#clearHistoryLink").show()}$("#clearHistoryLink").click(function(){$("#searchHistoryContentAndLinks").hide();$("#searchHistoryCleared").show();icl.ut.writeCookie(wsNs.constants.historyCookie,"",wsNs.constants.historyCookieDomain,"/");return false});$("#showHistoryLink").click(function(){$("#searchHistoryContent").show();$("#hideHistoryLink").show();$("#showHistoryLink").hide();icl.ut.writeCookie("__hideHistory","",wsNs.constants.historyCookieDomain,"/");return false});$("#hideHistoryLink").click(function(){$("#searchHistoryContent").hide();$("#hideHistoryLink").hide();$("#showHistoryLink").show();icl.ut.writeCookie("__hideHistory","1",wsNs.constants.historyCookieDomain,"/");return false})};wsNs.registerSort=function(){$('input:radio[name="'+wsNs.constants.sortParam+'"],select[name="'+wsNs.constants.sortParam+'"]').change(function(){var c=$(this).val();var a=$(this).attr(wsNs.constants.coidAttribute);var b=$(this).attr(wsNs.constants.copAttribute);var d=window.location.href;d=wsNs.updateParameterInQueryString(wsNs.constants.sortParam,c,d);d=wsNs.updateParameterInQueryString(wsNs.constants.pageIndex,1,d);if(a&&b){iclog.logClick(function(){window.location.href=d},a,b)}else{window.location.href=d}})};wsNs.registerAdvSearch=function(){var e=$("div.advancedSearchPane");var d=$("div.advancedSearchLink a");var c=$("div.advancedSearchCloseLink");var f=$("div.advancedSearchScreen");$("html").css("min-height",$(window).height());var j=$("html").height()+"px";var k=$("#page").width();var h=20;var b=$("#extendedLinksArea").position()!=null?$("#extendedLinksArea").position().top+$("#extendedLinksArea").height()+h:0;var a=(k/2)-(e.width()/2);e.css("position","absolute");e.css("top",b);e.css("left",a);f.css("height",j);e.hide();$("body.bodyAdvancedSearch #header .advancedSearchPane").show();$("body.bodyAdvancedSearch #header .advancedSearchScreen").show();$('body.bodyAdvancedSearch input[name="q"]').attr("disabled",true);$('body.bodyAdvancedSearch input[id="topSearchSubmit"]').attr("disabled",true).css("cursor","default");if(wsNs.constants.isAdvSearchView){return}d.click(function(){if(e.is(":visible")){wsNs.hideAdvSearch(e,d)}else{wsNs.showAdvSearch(e,d)}return false});c.click(function(){if(e.is(":visible")){wsNs.hideAdvSearch(e,d)}return false});f.click(function(){if(e.is(":visible")){wsNs.hideAdvSearch(e,d)}return false});var g=$('div.advancedSearchInputPane div.keywordInput input[type="text"]');var i=$("#qall");$("#topSearchTextBox").change(function(){g.val("");i.val($(this).val())})};wsNs.registerTabs=function(){if(wsNs.constants.categoryUrls&&!wsNs.constants.isAdvSearchView){$("div.searchBoxCategories a").click(function(){var e=$(this).parent().parent().attr("class").split(" ")[0];var f=wsNs.constants.categoryUrls[e];if(!f){return true}$("div.searchBoxInput form").attr("action",f.catUrl);$("div.preferencesLink a").attr("href",f.prefUrl);$("div.advancedSearchLink a").attr("href",f.advUrl);var c=$("input.searchBoxTextInput");var d=$("input.searchBoxLocationInput");var g=iSuggest&&typeof iSuggest.setActive==="function";if(e=="categoryVideo"||e=="categoryNews"||e=="categoryLocal"){$("div.advancedSearchLink").hide();$("div#engineAttributionPane").hide();var b=$("div.advancedSearchPane");var a=$("div.advancedSearchLink a");if(b.css("display")=="block"){wsNs.hideAdvSearch(b,a)}if(e=="categoryLocal"){d.val(d.attr("data-core-value")).show();c.addClass("localSearchBoxTextInput");if(g){iSuggest.setActive(false)}}else{if(d.val()){d.attr("data-core-value",d.val()).val("")}d.hide();c.removeClass("localSearchBoxTextInput");if(g){iSuggest.setActive(true)}}}else{$("div.advancedSearchLink").show();if(d.val()){d.attr("data-core-value",d.val()).val("")}d.hide();c.removeClass("localSearchBoxTextInput");if(g){iSuggest.setActive(true)}if(e=="categoryWeb"){$("div.imageFilters").hide();$("div.webFilters").show();$("div#engineAttributionPane").show()}else{if(e=="categoryImages"){$("div.webFilters").hide();$("div.imageFilters").show();$("div#engineAttributionPane").hide()}}}iclog.logClick(null,$(this).attr(wsNs.constants.coidDeferAttribute),$(this).attr(wsNs.constants.copDeferAttribute));return false})}else{$("#topSearchTextBox").change(function(){var a=$("div.searchBoxCategories a");for(var c=0;c<a.length;++c){var b=wsNs.updateParameterInQueryString(wsNs.constants.keywordQuery,$(this).val(),a.get(c).href);a.get(c).href=b}})}};wsNs.registerClickableRegion=function(a,b){$(a).click(function(){var e=b(this);var c=e.attr(wsNs.constants.coidAttribute);var d=e.attr(wsNs.constants.copAttribute);if(wsNs.constants.openInNewWindow==true){window.open(e.attr("href"))}else{window.location=e.attr("href")}iclog.logClick(null,c,d);return false})};wsNs.primeLocalListingPrintDialogContent=function(){var a=$("#localListingPrintDialog").clone();a.find("div.printDialogGeneral").append($("#resultsMain div.localListingResultInfo div.businessInfo").clone()).append($("#resultsMain div.localListingResultInfo div.localBusinessHours").clone()).find("div.businessWebsite").hide().end().end().find("div.printDialogMap").append('<img src="'+wsNs.staticMap+'" height="'+wsNs.staticMapHeight+'" width="'+wsNs.staticMapWidth+'" />').end().find("div.printDialogOverview").append($("#resultsMain div.localListingResultInfo div.localCategories").clone()).append($("#overView").clone()).find("span.localCategoriesMore").hide().end().find("#localCategoriesHidden").show().end().end().find("div.printDialogContent a").replaceWith(function(){return $('<span class="linkReplace"></span>').append($(this).contents())}).end().find(".ui-tabs-panel").removeClass("ui-tabs-panel ui-widget-content ui-corner-bottom").end().find("div.printLink a").click(function(){window.print()}).end().show().appendTo($("#printArea, #dialog").empty());return a};wsNs.setCustomValidators=function(){$.validator.addMethod("requiredGroup",function(c,b){var a=$(b).parents("form");return a.find("input.requiredGroup:filled").length},"");$.validator.addMethod("requiredIfVisible",function(b,a){return $(a).is(":not(:visible)")||b!=""},"")};wsNs.init=function(){wsNs.registerAdvSearch();wsNs.registerTabs();wsNs.registerSort();wsNs.registerSearchHistory();wsNs.setCustomValidators();if(iclog){iclog.registerLogClick($("a["+wsNs.constants.coidAttribute+"]").get())}if(!$(document.body).is(".bodyResults")){$("#topSearchTextBox").focus()}};$(function(){wsNs.init()});var ptTopSearchBox={};ptTopSearchBox.id="topSearchTextBox";ptTopSearchBox.callback=function(){$('#topSearchForm input[name="fcoid"]').val("114");$("#topSearchForm").attr(wsNs.constants.coidAttribute,"114");$("#topSearchForm").submit()};var ptBottomSearchBox={};ptBottomSearchBox.id="bottomSearchTextBox";ptBottomSearchBox.callback=function(){$('#bottomSearchForm input[name="fcoid"]').val("114");$("#bottomSearchForm").attr(wsNs.constants.coidAttribute,"114");$("#bottomSearchForm").submit()};ptBottomSearchBox.openOverSearchBox=true;var ispace_txtElements=[ptTopSearchBox,ptBottomSearchBox];wsNs.registerSearchHistory=function(){if(icl.ut.getCookie("__hideHistory")=="1"){$("#showHistoryLink").show();$("#hideHistoryLink").hide();$("#searchHistoryContent").hide();$("#clearHistoryLink").show()}else{$("#showHistoryLink").hide();$("#hideHistoryLink").show();$("#clearHistoryLink").show()}$("#clearHistoryLink").click(function(){$("#searchHistoryContentAndLinks").hide();$("#showHistoryLink").hide();$("#hideHistoryLink").hide();$("#searchHistoryCleared").show();icl.ut.writeCookie(wsNs.constants.historyCookie,"",null,"/");return false});$("#showHistoryLink").click(function(){$("#searchHistoryContent").show();$("#hideHistoryLink").show();$("#showHistoryLink").hide();$("#clearHistoryLink").show();icl.ut.writeCookie("__hideHistory","",null,"/");return false});$("#hideHistoryLink").click(function(){$("#searchHistoryContent").hide();$("#hideHistoryLink").hide();$("#showHistoryLink").show();$("#clearHistoryLink").hide();icl.ut.writeCookie("__hideHistory","1",null,"/");return false})};wsNs.registerSort=function(){$('input:radio[name="'+wsNs.constants.sortParam+'"],select[name="'+wsNs.constants.sortParam+'"]').not(".stateSelectList").change(function(){var c=$(this).val();var a=$(this).attr(wsNs.constants.coidAttribute);var b=$(this).attr(wsNs.constants.copAttribute);var d=window.location.href;d=wsNs.updateParameterInQueryString(wsNs.constants.sortParam,c,d);d=wsNs.updateParameterInQueryString(wsNs.constants.pageIndex,1,d);if(a&&b){iclog.logClick(function(){window.location.href=d},a,b)}else{window.location.href=d}})};wsNs.registerTabs=function(){if(wsNs.constants.categoryUrls&&!wsNs.constants.isAdvSearchView){$("div.searchBoxCategories a").click(function(){var e=$(this).parent().parent().attr("class").split(" ")[0];var f=wsNs.constants.categoryUrls[e];if(!f){return true}$("div.searchBoxInput form").attr("action",f.catUrl);$("div.preferencesLink a").attr("href",f.prefUrl);$("div.advancedSearchLink a").attr("href",f.advUrl);$("div.searchBoxCategories").find("a").removeClass("categoryLinkActive").closest("li").removeClass("active");$(this).addClass("categoryLinkActive").closest("li").addClass("active");var c=$("input.searchBoxTextInput");var d=$("input.searchBoxLocationInput");var g=iSuggest&&typeof iSuggest.setActive==="function";if(e=="categoryVideo"||e=="categoryNews"||e=="categoryLocal"){$("div.advancedSearchLink").hide();var b=$("div.advancedSearchPane");var a=$("div.advancedSearchLink a");if(b.css("display")=="block"){wsNs.hideAdvSearch(b,a)}$("div.engineAttributionPane").hide();if(e=="categoryLocal"){d.val(d.attr("data-core-value")).show();c.addClass("localSearchBoxTextInput");if(g){iSuggest.setActive(false)}}else{if(d.val()){d.attr("data-core-value",d.val()).val("")}d.hide();c.removeClass("localSearchBoxTextInput");if(g){iSuggest.setActive(true)}}}else{$("div.advancedSearchLink").show();if(d.val()){d.attr("data-core-value",d.val()).val("")}d.hide();c.removeClass("localSearchBoxTextInput");if(g){iSuggest.setActive(true)}if(e=="categoryWeb"){$("div.imageFilters").hide();$("div.webFilters").show();$("div.engineAttributionPane").show()}else{if(e=="categoryImages"){$("div.webFilters").hide();$("div.imageFilters").show();$("div.engineAttributionPane").hide()}}}iclog.logClick(null,$(this).attr(wsNs.constants.coidDeferAttribute),$(this).attr(wsNs.constants.copDeferAttribute));return false})}else{$("#topSearchTextBox").change(function(){var a=$("div.searchBoxCategories a");for(var c=0;c<a.length;++c){var b=wsNs.updateParameterInQueryString(wsNs.constants.keywordQuery,$(this).val(),a.get(c).href);a.get(c).href=b}})}};$(window).resize(function(){$("div.advancedSearchPane").center();$("html").css("min-height",$(window).height());var a=$("html").height()+"px";$("div.advancedSearchScreen").css("min-height",a)});jQuery.fn.center=function(){this.css("position","absolute");this.css("left",(($(window).width()-this.outerWidth())/2)+$(window).scrollLeft()+"px");return this};if($(window).width()<992){$("#resultsAdsSb").appendTo("#resultsAdsBottom")}var stickyAylf=$("#stickyAylf");var stickyPadding=$("#stickyPadding");if(stickyAylf.length&&stickyPadding.length){var fixed=false;var removeFixedValue=0;$(window).scroll(function(){var a=$(window).scrollTop()-stickyAylf.offset().top;if(!fixed&&a>=-5){stickyAylf.addClass("fixedAylf");stickyPadding.css("padding-top",stickyAylf.css("height"));fixed=true;removeFixedValue=$(window).scrollTop()-5}if(fixed&&removeFixedValue>=$(window).scrollTop()){stickyAylf.removeClass("fixedAylf");stickyPadding.css("padding-top","0");fixed=false}})};